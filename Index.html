<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HarmonyStream | Professional Music Player</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="Professional music player for online streaming and local files">
    <link rel="manifest" href="manifest.json">
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="player.css">
    <link rel="stylesheet" href="playlist.css">
    <link rel="stylesheet" href="responsive.css">
    
    <!-- Libraries -->
    <script src="https://unpkg.com/wavesurfer.js"></script>
    <script src="https://unpkg.com/jsmediatags@3.9.7/dist/jsmediatags.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <p>Loading your music experience...</p>
    </div>

    <!-- Main Container -->
    <div class="container" id="mainContainer" style="display: none;">
        <!-- Header -->
        <header>
            <div class="logo">
                <i class="fas fa-music"></i>
                <span>HarmonyStream Pro</span>
            </div>
            
            <div class="header-controls">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search songs, artists, albums...">
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <div class="user-actions">
                    <button class="btn-icon" id="themeToggle" title="Toggle theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="btn-icon" id="equalizerToggle" title="Equalizer">
                        <i class="fas fa-sliders-h"></i>
                    </button>
                    <button class="btn-icon" id="sleepTimerBtn" title="Sleep Timer">
                        <i class="fas fa-bed"></i>
                    </button>
                    <button class="btn upload-btn" id="uploadTrigger">
                        <i class="fas fa-cloud-upload-alt"></i>
                        Upload Files
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Column: Player & Visualization -->
            <div class="left-column">
                <!-- Now Playing Section -->
                <section class="player-section card">
                    <div class="section-header">
                        <h2><i class="fas fa-play-circle"></i> Now Playing</h2>
                        <div class="section-actions">
                            <button class="btn-icon" id="repeatBtn" title="Repeat">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="btn-icon" id="shuffleBtn" title="Shuffle">
                                <i class="fas fa-random"></i>
                            </button>
                            <button class="btn-icon" id="favoriteBtn" title="Add to favorites">
                                <i class="far fa-heart"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Album Art & Info -->
                    <div class="song-info">
                        <div class="album-art-container">
                            <div class="album-art" id="albumArt">
                                <div class="vinyl-record" id="vinylRecord">
                                    <div class="vinyl-center"></div>
                                </div>
                                <img src="" alt="Album Art" id="albumArtImg" style="display: none;">
                                <i class="fas fa-music fallback-icon"></i>
                            </div>
                            <div class="vinyl-controls">
                                <button class="btn-icon small" id="vinylToggle">
                                    <i class="fas fa-compact-disc"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="song-details">
                            <h1 class="song-title" id="songTitle">Select a song to play</h1>
                            <p class="song-artist" id="songArtist">Artist name</p>
                            <p class="song-album" id="songAlbum">Album name</p>
                            
                            <div class="song-stats">
                                <span class="stat">
                                    <i class="fas fa-play"></i>
                                    <span id="playCount">0 plays</span>
                                </span>
                                <span class="stat">
                                    <i class="fas fa-calendar"></i>
                                    <span id="songYear">2023</span>
                                </span>
                                <span class="stat">
                                    <i class="fas fa-music"></i>
                                    <span id="songBitrate">320kbps</span>
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Waveform Visualization -->
                    <div class="visualization-section">
                        <div id="waveform"></div>
                        <canvas id="audioVisualizer" width="800" height="100"></canvas>
                    </div>

                    <!-- Player Controls -->
                    <div class="player-controls">
                        <div class="progress-area">
                            <div class="progress-bar" id="progressBar">
                                <div class="progress" id="progress"></div>
                                <div class="progress-handle" id="progressHandle"></div>
                            </div>
                            <div class="timer">
                                <span class="current-time" id="currentTime">0:00</span>
                                <span class="duration" id="duration">0:00</span>
                            </div>
                        </div>

                        <div class="controls-main">
                            <button class="control-btn" id="prevBtn" title="Previous">
                                <i class="fas fa-step-backward"></i>
                            </button>
                            <button class="control-btn" id="rewindBtn" title="Rewind 10s">
                                <i class="fas fa-backward"></i>
                            </button>
                            <button class="control-btn play-pause" id="playPauseBtn" title="Play/Pause">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="control-btn" id="forwardBtn" title="Forward 10s">
                                <i class="fas fa-forward"></i>
                            </button>
                            <button class="control-btn" id="nextBtn" title="Next">
                                <i class="fas fa-step-forward"></i>
                            </button>
                        </div>

                        <div class="controls-secondary">
                            <div class="volume-control">
                                <button class="btn-icon" id="muteBtn" title="Mute">
                                    <i class="fas fa-volume-up"></i>
                                </button>
                                <div class="volume-slider" id="volumeSlider">
                                    <div class="volume-percent" id="volumePercent"></div>
                                </div>
                            </div>
                            
                            <div class="playback-rate">
                                <span>Speed:</span>
                                <select id="playbackRate">
                                    <option value="0.5">0.5x</option>
                                    <option value="0.75">0.75x</option>
                                    <option value="1" selected>1x</option>
                                    <option value="1.25">1.25x</option>
                                    <option value="1.5">1.5x</option>
                                    <option value="2">2x</option>
                                </select>
                            </div>
                            
                            <button class="btn-icon" id="lyricsToggle" title="Show Lyrics">
                                <i class="fas fa-microphone-alt"></i>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Lyrics Section -->
                <section class="lyrics-section card" id="lyricsSection" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-microphone-alt"></i> Lyrics</h3>
                        <button class="btn-icon" id="syncLyricsToggle">
                            <i class="fas fa-link"></i> Sync
                        </button>
                    </div>
                    <div class="lyrics-container" id="lyricsContainer">
                        <p class="no-lyrics">No lyrics available for this track</p>
                    </div>
                </section>

                <!-- Online Streaming -->
                <section class="streaming-section card">
                    <div class="section-header">
                        <h3><i class="fas fa-globe"></i> Online Radio</h3>
                        <div class="radio-genres">
                            <select id="radioGenre">
                                <option value="all">All Genres</option>
                                <option value="pop">Pop</option>
                                <option value="rock">Rock</option>
                                <option value="jazz">Jazz</option>
                                <option value="electronic">Electronic</option>
                                <option value="classical">Classical</option>
                            </select>
                        </div>
                    </div>
                    <div class="radio-stations" id="radioStations">
                        <!-- Radio stations will be loaded here -->
                    </div>
                </section>
            </div>

            <!-- Right Column: Playlists & Library -->
            <div class="right-column">
                <!-- Library Navigation -->
                <div class="library-nav">
                    <button class="nav-btn active" data-view="playlist">
                        <i class="fas fa-list"></i> Playlist
                    </button>
                    <button class="nav-btn" data-view="albums">
                        <i class="fas fa-compact-disc"></i> Albums
                    </button>
                    <button class="nav-btn" data-view="artists">
                        <i class="fas fa-user"></i> Artists
                    </button>
                    <button class="nav-btn" data-view="favorites">
                        <i class="fas fa-heart"></i> Favorites
                    </button>
                </div>

                <!-- Playlist View -->
                <section class="playlist-section card active-view" id="playlistView">
                    <div class="section-header">
                        <h3><i class="fas fa-list"></i> Current Playlist</h3>
                        <div class="playlist-actions">
                            <button class="btn-icon" id="clearPlaylist" title="Clear Playlist">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="btn-icon" id="savePlaylist" title="Save Playlist">
                                <i class="fas fa-save"></i>
                            </button>
                            <button class="btn-icon" id="importPlaylist" title="Import Playlist">
                                <i class="fas fa-file-import"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="playlist-info">
                        <span id="playlistCount">0 tracks</span>
                        <span id="playlistDuration">0:00</span>
                    </div>
                    
                    <div class="playlist-container">
                        <table class="playlist-table" id="playlistTable">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Title</th>
                                    <th>Artist</th>
                                    <th>Album</th>
                                    <th><i class="far fa-clock"></i></th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="playlistBody">
                                <!-- Playlist items will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Albums View -->
                <section class="albums-section card" id="albumsView" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-compact-disc"></i> Albums</h3>
                    </div>
                    <div class="albums-grid" id="albumsGrid">
                        <!-- Albums will be loaded here -->
                    </div>
                </section>

                <!-- Artists View -->
                <section class="artists-section card" id="artistsView" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-user"></i> Artists</h3>
                    </div>
                    <div class="artists-list" id="artistsList">
                        <!-- Artists will be loaded here -->
                    </div>
                </section>

                <!-- Favorites View -->
                <section class="favorites-section card" id="favoritesView" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-heart"></i> Favorites</h3>
                    </div>
                    <div class="favorites-list" id="favoritesList">
                        <!-- Favorites will be loaded here -->
                    </div>
                </section>
            </div>
        </main>

        <!-- Audio Player (hidden) -->
        <audio id="audioPlayer" preload="metadata"></audio>
        
        <!-- Screen Reader Announcements -->
        <div id="liveRegion" aria-live="polite" aria-atomic="true" class="sr-only"></div>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <div class="player-status" id="playerStatus">
                    <span class="status-icon"><i class="fas fa-play"></i></span>
                    <span id="nowPlayingText">Not Playing</span>
                </div>
                <div class="player-stats">
                    <span>Total Tracks: <span id="totalTracks">0</span></span>
                    <span>Listening Time: <span id="totalTime">0h</span></span>
                    <span>Storage: <span id="storageUsed">0 MB</span></span>
                </div>
                <p class="copyright">HarmonyStream Pro &copy; 2023 | Professional Music Player</p>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <!-- Equalizer Modal -->
    <div class="modal" id="equalizerModal">
        <div class="modal-content">
            <!-- Equalizer content will be loaded by equalizer.js -->
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <!-- Upload content will be loaded by upload.js -->
        </div>
    </div>

    <!-- Sleep Timer Modal -->
    <div class="modal" id="sleepTimerModal">
        <div class="modal-content">
            <!-- Sleep timer content will be loaded by player.js -->
        </div>
    </div>

    <!-- Lyrics Search Modal -->
    <div class="modal" id="lyricsSearchModal">
        <div class="modal-content">
            <!-- Lyrics search content will be loaded by lyrics.js -->
        </div>
    </div>

    <!-- Import/Export Modal -->
    <div class="modal" id="importExportModal">
        <div class="modal-content">
            <!-- Import/Export content will be loaded by playlist.js -->
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="utils.js"></script>
    <script src="player.js"></script>
    <script src="playlist.js"></script>
    <script src="metadata.js"></script>
    <script src="visualizer.js"></script>
    <script src="equalizer.js"></script>
    <script src="lyrics.js"></script>
    <script src="offline.js"></script>
    <script src="analytics.js"></script>
    <script src="keyboard.js"></script>
    <script src="upload.js"></script>
    <script src="app.js"></script>
    
    <!-- Initialize Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log('Service Worker Registered'))
                .catch(err => console.log('Service Worker Registration Failed:', err));
        }
    </script>
</body>
</html>
